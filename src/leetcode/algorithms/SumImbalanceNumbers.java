package leetcode.algorithms;

/**
 * Description: 2763. Sum of Imbalance Numbers of All Subarrays
 *
 * @author Baltan
 * @date 2023/7/17 22:56
 */
public class SumImbalanceNumbers {
    public static void main(String[] args) {
        System.out.println(sumImbalanceNumbers(new int[]{2, 3, 1, 4}));
        System.out.println(sumImbalanceNumbers(new int[]{1, 3, 3, 3, 5}));
        System.out.println(sumImbalanceNumbers(new int[]{552, 680, 682, 438, 452, 80, 599, 697, 32, 835, 62, 949, 675, 12, 694, 490, 421, 373, 578, 107, 29, 655, 263, 728, 435, 82, 729, 645, 75, 567, 16, 353, 366, 203, 532, 193, 805, 372, 48, 377, 460, 771, 217, 408, 496, 829, 901, 21, 731, 807, 102, 929, 630, 461, 722, 202, 239, 548, 375, 638, 200, 457, 349, 136, 723, 577, 712, 993, 528, 937, 941, 601, 513, 198, 834, 232, 393, 326, 354, 546, 918, 401, 499, 87, 634, 175, 208, 209, 453, 130, 815, 133, 596, 997, 168, 967, 425, 76, 63, 318, 380, 451, 837, 896, 922, 845, 254, 956, 418, 895, 989, 399, 246, 892, 676, 414, 637, 437, 621, 129, 356, 221, 619, 444, 315, 42, 849, 789, 691, 255, 885, 115, 358, 409, 784, 201, 322, 509, 847, 560, 620, 427, 275, 34, 673, 171, 47, 662, 980, 53, 261, 299, 413, 891, 126, 212, 186, 884, 700, 803, 782, 748, 419, 848, 480, 865, 97, 347, 958, 658, 112, 342, 985, 443, 860, 236, 733, 269, 330, 828, 873, 26, 360, 325, 984, 791, 223, 602, 962, 389, 635, 969, 69, 632, 258, 450, 543, 81, 563, 702, 334, 445, 59, 33, 51, 858, 442, 742, 876, 809, 981, 693, 983, 818, 750, 50, 725, 101, 976, 971, 883, 822, 306, 355, 909, 226, 474, 736, 811, 13, 432, 707, 527, 376, 123, 57, 739, 231, 507, 549, 710, 765, 262, 348, 483, 320, 986, 894, 852, 624, 328, 794, 219, 516, 37, 176, 570, 405, 491, 755, 970, 520, 987, 391, 60, 291, 284, 518, 71, 586, 824, 371, 350, 267, 708, 511, 793, 977, 378, 959, 536, 364, 470, 127, 494, 503, 8, 897, 235, 823, 515, 18, 661, 790, 65, 654, 359, 156, 625, 317, 679, 184, 472, 117, 38, 727, 519, 400, 273, 370, 774, 174, 752, 249, 323, 308, 113, 584, 4, 434, 531, 7, 914, 164, 290, 31, 609, 228, 868, 216, 668, 118, 580, 607, 716, 862, 289, 965, 220, 384, 191, 568, 642, 938, 307, 241, 907, 681, 705, 911, 293, 179, 686, 571, 404, 195, 145, 124, 501, 170, 285, 99, 843, 177, 498, 522, 575, 952, 589, 626, 477, 551, 295, 396, 904, 36, 640, 663, 10, 270, 19, 139, 688, 155, 464, 950, 598, 857, 68, 719, 292, 27, 582, 321, 324, 72, 699, 872, 542, 538, 687, 783, 754, 615, 120, 825, 22, 933, 999, 855, 512, 558, 762, 161, 162, 672, 995, 238, 466, 469, 870, 93, 684, 385, 934, 916, 569, 846, 103, 388, 991, 77, 797, 344, 948, 92, 871, 622, 879, 416, 214, 215, 919, 796, 192, 639, 45, 173, 927, 906, 35, 146, 689, 660, 529, 94, 54, 888, 147, 287, 982, 302, 352, 89, 39, 429, 651, 17, 955, 893, 70, 695, 143, 151, 312, 197, 760, 646, 653, 338, 819, 183, 343, 505, 821, 534, 631, 96, 417, 928, 369, 813, 187, 882, 178, 786, 881, 861, 592, 351, 671, 185, 864, 314, 957, 114, 804, 141, 294, 866, 770, 745, 587, 595, 134, 5, 387, 9, 562, 415, 641, 382, 473, 910, 714, 954, 244, 931, 530, 11, 410, 628, 316, 768, 311, 706, 497, 751, 701, 777, 749, 612, 623, 79, 833, 363, 167, 489, 280, 266, 3, 15, 996, 182, 448, 525, 56, 960, 116, 218, 614, 84, 98, 278, 52, 537, 243, 773, 6, 656, 340, 394, 398, 492, 692, 945, 128, 28, 912, 264, 61, 165, 766, 890, 926, 482, 605, 585, 718, 423, 319, 430, 24, 181, 211, 767, 917, 616, 800, 564, 814, 524, 131, 743, 877, 657, 930, 339, 594, 886, 305, 436, 744, 953, 889, 903, 46, 104, 265, 55, 336, 368, 820, 309, 690, 667, 152, 210, 936, 462, 78, 887, 229, 467, 842, 166, 643, 683, 390, 189, 550, 169, 924, 465, 611, 272, 669, 149, 827, 157, 831, 787, 832, 459, 428, 407, 159, 431, 199, 647, 633, 547, 944, 194, 142, 449, 853, 629, 90, 544, 566, 160, 604, 286, 715, 333, 403, 301, 659, 775, 943, 806, 83, 665, 913, 125, 256, 331, 778, 493, 588, 206, 204, 650, 357, 49, 678, 25, 685, 780, 245, 481, 617, 303, 304, 816, 652, 798, 703, 869, 392, 367, 233, 826, 756, 121, 964, 365, 850, 422, 972, 471, 572, 257, 539, 446, 379, 574, 812, 420, 696, 523, 153, 776, 559, 565, 250, 95, 260, 698, 234, 119, 479, 792, 720, 283, 836, 337, 704, 247, 880, 801, 281, 253, 935, 67, 242, 840, 412, 144, 810, 458, 795, 207, 439, 608, 41, 854, 753, 510, 282, 362, 487, 994, 968, 540, 939, 259, 14, 506, 313, 526, 441, 856, 610, 213, 455, 277, 844, 597, 158, 475, 841, 763, 240, 64, 85, 296, 579, 23, 381, 180, 484, 557, 600, 838, 998, 148, 974, 345, 990, 406, 940, 830, 666, 224, 932, 225, 476, 735, 947, 521, 73, 859, 721, 875, 713, 644, 274, 276, 961, 545, 329, 737, 963, 779, 402, 172, 561, 740, 86, 581, 627, 591, 332, 772, 500, 902, 271, 603, 456, 677, 424, 664, 109, 122, 395, 58, 230, 111, 40, 758, 341, 222, 769, 573, 298, 923, 908, 951, 248, 374, 741, 335, 717, 874, 486, 973, 251, 788, 140, 297, 992, 468, 135, 555, 1, 905, 863, 785, 915, 252, 808, 726, 921, 454, 898, 978, 110, 44, 878, 761, 504, 979, 851, 975, 502, 738, 757, 764, 66, 759, 30, 535, 300, 91, 43, 440, 649, 463, 942, 88, 920, 711, 593, 495, 730, 138, 327, 817, 541, 583, 781, 106, 514, 268, 966, 533, 867, 925, 590, 553, 137, 554, 188, 734, 105, 802, 517, 732, 108, 190, 1000, 163, 485, 433, 196, 383, 670, 310, 508, 227, 100, 154, 288, 674, 279, 648, 618, 747, 237, 799, 606, 988, 205, 636, 132, 576, 447, 2, 488, 709, 946, 386, 556, 361, 397, 613, 426, 746, 839, 900, 478, 411, 20, 74, 346, 150, 724, 899}));
    }

    /**
     * 参考：<a href="https://leetcode.cn/problems/sum-of-imbalance-numbers-of-all-subarrays/solutions/2327214/bao-li-mei-ju-pythonjavacgo-by-endlessch-2r7p/"></a>
     *
     * @param nums
     * @return
     */
    public static int sumImbalanceNumbers(int[] nums) {
        int result = 0;
        int length = nums.length;

        for (int i = 0; i < length; i++) {
            /**
             * isVisited[x]表示以nums[i]为左端点的子数组中是否出现过数字x，根据题意，x∈[1,1000]
             */
            boolean[] isVisited = new boolean[1002];
            isVisited[nums[i]] = true;
            /**
             * 以nums[i]为左端点的子数组中的不平衡数字
             */
            int count = 0;

            for (int j = i + 1; j < length; j++) {
                /**
                 * 1、如果数字nums[j]在子数组中已经出现过，则nums[j]不会改变不平衡数字
                 * 2、如果数字nums[j]在子数组中没有出现过
                 *      1、如果数字nums[j]-1和数字nums[j]+1都没有出现过
                 *          1、如果存在数字x和y，满足nums[j]-x>1和y-nums[j]>1，则子数组中加入nums[j]后，会使得不平衡数字加2，即x和
                 *          nums[j]、nums[j]和y，同时会使得不平衡数字减1，即x和y，最终使得不平衡数字加1
                 *          2、如果只存在数字x，满足nums[j]-x>1，则子数组中加入nums[j]后，会使得不平衡数字加1，即x和nums[j]
                 *          3、如果只存在数字y，满足y-nums[j]>1，则子数组中加入nums[j]后，会使得不平衡数字加1，即nums[j]和y
                 *      2、如果只出现过数字nums[j]-1
                 *          1、如果存在数字y，满足y-nums[j]>1，则子数组中加入nums[j]后，会使得不平衡数字加1，即nums[j]和y，同时会使
                 *          得不平衡数字减1，即nums[j]-1和y，最终使得不平衡数字不变
                 *          2、因为nums[j]-1和nums[j]之差不大于1，所以不需要考虑子数组中小于nums[j]的数字
                 *      3、如果只出现过数字nums[j]+1
                 *          1、如果存在数字x，满足nums[j]-x>1，则子数组中加入nums[j]后，会使得不平衡数字加1，即x和nums[j]，同时会使
                 *          得不平衡数字减1，即x和nums[j]+1，最终使得不平衡数字不变
                 *          2、因为nums[j]和nums[j]+1之差不大于1，所以不需要考虑子数组中大于nums[j]的数字
                 *      4、如果数字nums[j]-1和数字nums[j]+1都出现过
                 *          1、会使得不平衡数字减1，即nums[j]-1和nums[j]+1
                 * 综上，如果数字nums[j]在子数组中没有出现过并且数字nums[j]-1和数字nums[j]+1都没有出现过，会使得不平衡数字加1；如果数字
                 * nums[j]在子数组中没有出现过并且数字nums[j]-1和数字nums[j]+1都出现过，会使得不平衡数字减1
                 */
                if (!isVisited[nums[j]]) {
                    if (!isVisited[nums[j] - 1] && !isVisited[nums[j] + 1]) {
                        count++;
                    } else if (isVisited[nums[j] - 1] && isVisited[nums[j] + 1]) {
                        count--;
                    }
                }
                /**
                 * 累计以nums[i]为左端点的子数组中的不平衡数字
                 */
                result += count;
                isVisited[nums[j]] = true;
            }
        }
        return result;
    }
}
