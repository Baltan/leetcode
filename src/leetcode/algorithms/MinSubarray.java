package leetcode.algorithms;

import java.util.HashMap;
import java.util.Map;
import java.util.Objects;

/**
 * Description: 1590. Make Sum Divisible by P
 *
 * @author Baltan
 * @date 2022/10/16 11:18
 */
public class MinSubarray {
    public static void main(String[] args) {
        System.out.println(minSubarray(
                new int[]{480672176, 576784321, 337624514, 794799569, 505630039, 441232360, 747229035,
                        151063465, 986241651, 557151426, 662076614, 270888417, 329170153, 412241185,
                        154538171, 499885566, 370121248, 937332078, 584382949, 599852738, 944759940,
                        956548740, 935994455, 40991371, 919460610, 449564511, 576711259, 376599943, 548151180,
                        660494949, 815951601, 9457413, 208238112, 104293348, 941032602, 108536019, 317713408,
                        602912560, 983508867, 328224507, 222243275, 795593923, 709208602, 563353728,
                        967996081, 749678651, 474494039, 129785273, 25504931, 122884165, 812002930, 145655271,
                        433972254, 789846180, 947333391, 323808904, 564366547, 524096046, 393510482,
                        833044396, 593108678, 255664468, 555693287, 249987671, 300379123, 965632822,
                        836947592, 280055417, 740263965, 673522731, 412154326, 822374080, 553353482,
                        527679600, 226875257, 49764097, 737554881, 14446682, 734598970, 818741808, 198522518,
                        761760640, 155437177, 909840097, 213919768, 906146330, 602854030, 227031533,
                        289544622, 630109468, 366586931, 756680521, 557173825, 690980667, 201302070,
                        680027685, 964634267, 902192125, 711468218, 929976427, 239441416, 7784051, 241028125,
                        864762322, 534742522, 523343320, 79268466, 941916967, 201833910, 360102794, 7003982,
                        585574155, 43839478, 139006104, 163624383, 363816675, 788626513, 523108461, 191136356,
                        947600633, 177885891, 550165488, 373088124, 664000875, 924108873, 757347880,
                        315176217, 30023808, 252536697, 149842220, 493197485, 463236379, 580075165, 62574915,
                        215478184, 648861051, 166231184, 511842823, 500194415, 76992226, 650745858, 406816983,
                        387454418, 220160117, 631700021, 782978537, 691561204, 936157007, 802345460,
                        589425737, 550136533, 221796402, 947805376, 393095996, 181905748, 624090512,
                        824604994, 353699615, 393598407, 177183109, 272960228, 202166952, 705268968,
                        562053099, 140494439, 759889241, 431227851, 354018309, 955494613, 952049132, 79099131,
                        562815016, 463805508, 983101751, 883737187, 270210521, 140756563, 916303333,
                        484030681, 862295180, 219618514, 633548244, 676021214, 638299361, 465711206,
                        988009927, 272593390, 161882194, 978910696, 529141354, 929795064, 377276178,
                        707453726, 927063496, 567567358, 283958811, 183034843, 397848372, 318967220,
                        901659568, 734885062, 646520844, 661118022, 835284726, 850764129, 383322820,
                        298867926, 586082541, 133233499, 87344963, 562933761, 769599403, 964005701, 245101840,
                        781018568, 401759767, 995425004, 697021630, 24888520, 272413204, 133292453, 548507692,
                        181451342, 572089063, 868102171, 192067768, 249812672, 544622144, 189562853,
                        135935693, 93656339, 438141654, 73836458, 776414889, 181526222, 278002187, 215908839,
                        539582809, 508340828, 393644584, 728399384, 289286968, 954221287, 750058789,
                        145767743, 218798968, 345952326, 876086779, 242841709, 952399376, 286656400,
                        481895841, 683464778, 723714001, 732711103, 890819717, 538743490, 524320333, 88204816,
                        655845329, 113147262, 688140725, 98434352, 954020800, 595881813, 618410965, 120579016,
                        472915400, 799227764, 94248990, 189064468, 294740275, 723897722, 320410610, 613724848,
                        558485184, 765010279, 212804884, 120581839, 256698260, 986895842, 178146174,
                        446578794, 652204356, 277627336, 359487435, 45240902, 960027340, 179695211, 758311507,
                        687106840, 797368034, 278816522, 364124585, 981060509, 279604945, 291257438, 5892404,
                        201455095, 207858162, 397248531, 573204179, 724954965, 988933137, 676225118,
                        168399606, 984331047, 30235371, 206268092, 910826709, 349212818, 279351647, 384629028,
                        705754264, 273599804, 799493144, 633212401, 169868971, 528903782, 448268245,
                        812954354, 40555700, 670927414, 764263735, 166529627, 639298475, 181402559, 533877986,
                        834219359, 971205640, 850334885, 352084515, 193669192, 391592911, 258878916,
                        400750750, 567865943, 112368265, 54176771, 802065704, 263931524, 873081294, 769953545,
                        564988175, 448425156, 480132741, 536545413, 221412504, 198767147, 597054614, 40275998,
                        301090576, 159248804, 709571583, 398663981, 569647682, 376200744, 218739718,
                        196149996, 870873768, 999491014, 165665664, 925612498, 64713469, 443197850, 247257047,
                        915681426, 218668729, 509960349, 433179287, 820655007, 52501965, 898092911, 487454618,
                        278224812, 905378223, 933746521, 537067293, 229417421, 251815535, 950210629,
                        453323579, 515421775, 929773531, 702662411, 697086386, 354960871, 540686046,
                        606706589, 975952797, 162917020, 449539647, 766510754, 25805898, 641027244, 710016827,
                        770694023, 128989829, 676545409, 9018815, 457590236, 996140658, 612794863, 886401869,
                        415552912, 487307857, 380461182, 610453571, 842703486, 483036831, 688042818,
                        597473120, 43737653, 659359404, 641483159, 261060997, 634822755, 35527607, 977915370,
                        257719041, 15414823, 916197302, 79435985, 767162064, 223312053, 435465792, 18505552,
                        663856618, 711255065, 393608162, 742805352, 645893807, 256521805, 444917599, 89097998,
                        624902233, 857534943, 72125627, 373886949, 141804905, 470520979, 562118213, 630838211,
                        28318663, 321348604, 829018841, 891107520, 481415403, 629339956, 734081714, 598097836,
                        824724643, 936555357, 272232349, 28209871, 894557956, 607295151, 477317480, 77747664,
                        285654722, 592291562, 729520997, 390705802, 269054194, 331172280, 103464684,
                        223608608, 644715305, 235247406, 483583886, 18625373, 696487656, 173607457, 190332159,
                        242869060, 375253426, 461505586, 538103389, 45152957, 946089300, 394203527, 265158159,
                        10708688, 627803208, 370678350, 691706162, 599187798, 778621622, 679315166, 524765639,
                        564258479, 445149479, 380106652, 112651872, 366256794, 951429870, 629581296, 85550558,
                        289761358, 408037233, 600876166, 225303518, 624289184, 858801915, 216962657,
                        388327486, 589133379, 388079886, 34358667, 745873041, 718462650, 838070769, 346562894,
                        757545465, 377558905, 253578435, 762680814, 375509818, 602261757, 573936130,
                        912586657, 786214323, 968068388, 469819011, 638996950, 479649374, 427421003,
                        614252087, 860378498, 156522047, 41992848, 43494268, 898670306, 336131171, 394225462,
                        970982427, 996876893, 989207126, 215575683, 206898543, 654893564, 909658568,
                        106106593, 665582012, 102134553, 316488280, 374255211, 23409894, 938398393, 708731131,
                        474809646, 84396699, 847836945, 806339193, 43334919, 859799274, 882015528, 49216766,
                        493365917, 111239652, 945278368, 911519709, 107224205, 1425149, 992827284, 735017777,
                        883140242, 256890253, 677611076, 827893021, 865654823, 576154220, 514809176,
                        680158839, 618969406, 61514994, 174183508, 911438638, 105182563, 866918669, 709283977,
                        186875440, 342766868, 193425713, 887513855, 174868153, 193301851, 599503393,
                        523242335, 832612288, 961508494, 449542368, 208494964, 846848633, 144763367, 61447328,
                        341047329, 439244333, 178099570, 570768205, 557143090, 32869925, 718240974, 107987374,
                        872296473, 189719612, 34290335, 953673158, 394652616, 777822592, 744451873, 139863904,
                        513931896, 519308568, 756981551, 348471211, 368349222, 641452738, 129083239,
                        936085335, 851472680, 105815894, 826556188, 990084169, 748892235, 98024724, 518715840,
                        548481584, 237928461, 16145666, 199892973, 624530906, 399896542, 745810894, 810285236,
                        989704379, 670535338, 83794807, 774684559, 787320005, 837611902, 742951100, 945449452,
                        288570723, 87226811, 340401763, 915002510, 169876822, 630807041, 353108242, 714745690,
                        375690180, 657182714, 43300026, 674850684, 886184664, 208195969, 696816601, 565030523,
                        760694690, 157643711, 12990483, 735499544, 87730356, 981125608, 776216685, 645721754,
                        904614823, 30501963, 5251058, 620403596, 945452636, 718172043, 687254824, 473239696,
                        163213968, 174755413, 457872315, 464525464, 755277730, 604768639, 929339198,
                        162007316, 840807840, 68933518, 280947708, 831705331, 38446877, 397348076, 475834452,
                        862501734, 644278498, 27624964, 72926900, 330259478, 913780253, 366293532, 184305223,
                        603662421, 179468945, 15586209, 403562145, 357897384, 273816481, 390111397, 497269179,
                        447685461, 551400856, 722241867, 749583844, 529401834, 541805937, 836323577, 31641345,
                        973041152, 269922164, 709244046, 794601574, 50426828, 657387162, 578342434, 490963720,
                        779625234, 434237527, 168493210, 45908950, 642751043, 339563713, 191048094, 33095756,
                        917816820, 834882187, 895299649, 478733203, 810093042, 108907647, 13476150, 702589071,
                        874004517, 10403656, 140266171, 948676141, 850796051, 136052389, 636008601, 893053220,
                        113957728, 629438535, 814729127, 990050518, 74343772, 683720071, 435535141, 393732401,
                        318820407, 41924418, 177462623, 755984994, 810486158, 810036803, 654537113, 216727388,
                        600148049, 619532057, 65109355, 163182376, 773301364, 120812017, 955429108, 103162276,
                        81545878, 416642018, 278198435, 843939348, 981245420, 204852215, 230650033, 835433193,
                        3505425, 194591096, 541785179, 424599534, 284131890, 762620766, 607564626, 519606994,
                        133650854, 727484763, 253797409, 752991392, 313230312, 749077057, 517391544,
                        677543930, 577579573, 252031017, 864345120, 119946716, 843940117, 20245231, 356265214,
                        174004025, 599850348, 404607914, 526303935, 95908211, 799860057, 342047150, 805523021,
                        537143918, 147817049, 473751016, 907753873, 971710603, 802240847, 584150721,
                        820896050, 602310424, 233129388, 225761763, 812737058, 650897245, 680129949,
                        827186482, 680953196, 600239716, 392607834, 106036579, 533658669, 775958358,
                        820841729, 922522178, 816335762, 789141612, 101450032, 304703858, 390690016,
                        178651860, 57492455, 191021049, 729775744, 61629127, 605868877, 570404828, 711253120,
                        642876783, 105572207, 751952788, 572369290, 200319094, 234493727, 620160204,
                        613093231, 574651747, 347724132, 176632776, 269662365, 472968525, 429645114, 77516557,
                        130647597, 725548993, 376706105, 12972442, 66008659, 241837943, 686390364, 354673518,
                        918125161, 96236766, 587445999, 255422443, 606221537, 95771578, 144194210, 432301436,
                        133074611, 758329574, 197051935, 647438043, 659423455, 451683239, 387049551,
                        713405552, 236776566, 923702638, 56752739, 485780782, 420734097, 690809028, 471775000,
                        329459223, 859053020, 981815593, 207591318, 263370607, 80394274, 265501649, 215319574,
                        583471498, 808064587, 66500195, 116654713, 541172457, 904761629, 694931935, 599372144,
                        962835051, 143922247, 237838200, 614999400, 126176290, 53210778, 794855566, 740816689,
                        449323357, 452660388, 910642450, 255347910, 320733050, 758982750, 560613805,
                        327614825, 951768895, 708920753, 109595827, 399002288, 201759112, 687442483,
                        531231566, 961004389, 866659535, 751398545, 457733678, 570691254, 945287817,
                        126946380, 276015715, 188539098, 113698299, 642152814, 955077400, 382032298,
                        494738252, 489746325, 820210537, 296353974, 540362740, 146343256, 482547863,
                        860667809, 881580499, 42925138, 34919137, 718954544, 821048364, 28454464, 401075438,
                        753667132, 492496246, 368878003, 874317572, 729504246, 277671718, 988683189,
                        892652015, 349144199, 29845139, 650086151, 59969860, 559374370, 569233656, 380085456,
                        96772302, 402319439, 768309878, 437301634, 498653791, 149694144, 622878663, 36728117,
                        4237785, 687714844, 70668595, 82154314, 184493472, 549025958, 587390348, 590212371,
                        851163679, 628309318, 135516960, 293739360, 115196055, 937872892, 415504134,
                        808677010, 9387904, 582134572, 629844136, 623865551, 983175507, 694073762, 297744098,
                        749527034, 773838574, 322520694, 320906074, 720778094, 287974652, 954813570,
                        914029606, 211528663, 266078447, 511511986, 950992213, 596459860, 878317911,
                        833349945, 977456990, 557617239, 187711381, 699665882, 233205926, 380463761,
                        653017716, 644742999, 398281807, 616317484, 367925741, 547732249, 693783033,
                        797914083, 142142182, 316492429, 397342502, 823189870, 50380046, 999580761, 840109172,
                        580542827, 71336397, 780797814, 651630856, 749715314, 713224997, 735938147, 337646464,
                        255511137, 715556832, 48903365, 666998368, 564921003, 968759420, 670322355, 370143324,
                        57485615, 303318744, 25525381, 645233744, 474322747, 213794773, 540807757, 244817021,
                        376884488, 10447084, 458083299, 245996330, 61804518, 507578713, 578275106, 338270882,
                        576096399, 943022687, 814895391, 560316440, 221019680, 740292972, 208654104,
                        324663312, 533886592, 225020199, 585736916, 741771324, 38896157, 748922152, 247232657,
                        41967650, 221529429, 300573270, 710219710, 85265711, 740773957, 205850231, 746373237,
                        214761417, 216622437, 969003948, 261417012, 986510878, 931263373, 517229318,
                        969914930, 939543959, 614488197, 696251506, 565623026, 856557875, 223530367,
                        963991462, 57818017, 578698309, 503489249, 852814112, 641165437, 930847370, 663426315,
                        995512320, 366860912, 410783675, 87491823, 274014342, 928982695, 947324971, 451829439,
                        208986361, 716975059, 667619250, 673454553, 156398737, 725614301, 382221416,
                        276456143, 106653720, 203858614, 894303112, 770446517, 321370673, 750813728,
                        622048633, 900958065, 674504121, 415241310, 710212050, 597632952, 339786676,
                        991553569, 600624805, 774505619, 648327899, 236369480, 744169534, 887391358,
                        532137159, 119722967, 864979927, 335599145, 569295786, 143638804, 579147796,
                        972865287, 231577756, 87777655, 51286961, 23697772, 320509183, 324760729, 204327787,
                        800923690, 904309868, 656114324, 66188036, 952721205, 822304663, 449935722, 94801248,
                        944340001, 810430985, 378618415, 931195415, 286880017, 504762983, 603592578,
                        868020475, 544568089, 604968850, 909566030, 992014869, 874998345, 817873408,
                        565071100, 938148235, 822521256, 322803458, 474431567, 326279445, 119028250,
                        464281549, 714893913, 742672151, 871790025, 476225287, 831463210, 875472828,
                        330772676, 223657092, 778959054, 72816017, 315120767, 111179205, 648215407, 558714473,
                        984226518, 89312476, 927249722, 187377411, 418225204, 63545674, 13175916, 335520364,
                        34683768, 559961661, 928153231, 299948671, 922820374, 562389813, 903910142, 356851301,
                        800773696, 973396326, 776350251, 339494924, 561571646, 368355990, 28153966, 567983309,
                        392735088, 544702366, 733355579, 662308424, 948677766, 390808837, 634632391,
                        767671843, 921402678, 319760039, 98221551, 870866658, 650199650, 29675161, 145870506,
                        579991598, 4963412, 86996789, 651650387, 334350669, 66838980, 3693645, 364424693,
                        674056979, 523261123, 411298097, 859853627, 782429074, 891645921, 788133739,
                        602491241, 698795147, 375011021, 678082385, 548721074, 848876597, 69260921, 638655329,
                        33022905, 933060361, 542462952, 483126719, 25375971, 414998715, 219576870, 538549644,
                        12245008, 552455002, 634543595, 700415176, 985051158, 122699253, 328922256, 827355866,
                        9677033, 478048843, 68991676, 477270205, 49147634, 132077239, 956027845, 699687818,
                        932651478, 545993019, 910581935, 860114888, 381782385, 242478626, 14333400, 517015801,
                        306523678, 656041038, 592588902, 59232277, 653761238, 244989135, 302999799, 601037483,
                        655612716, 339903670, 411615945, 455285522, 374248428, 451981205, 304159287,
                        778542485, 283842530, 571792632, 460473760, 565600210, 423706266, 532542566,
                        302431071, 520626242, 162860389, 212393718, 85480230, 111336325, 849688765, 565664816,
                        81704918, 438893911, 903893864, 56597526, 232867824, 399640662, 764814672, 353651737,
                        699703997, 490209447, 756504415, 296306325, 334955239, 12908740, 906446704, 744972168,
                        887814240, 778142249, 641195580, 515694609, 524111785, 448058226, 603307183,
                        533152750, 161050822, 919343506, 50309212, 245471364, 732717276, 931432186, 453510943,
                        884548268, 915362384, 663799642, 454031708, 896497987, 736661367, 442149238,
                        673236478, 376605032, 551546812, 800678823, 189901441, 167387490, 527920100,
                        374836396, 997452508, 450448826, 894848606, 526215505, 392102681, 945963920, 98721208,
                        341726762, 511715414, 270429197, 894606951, 519920027, 268665786, 198440273,
                        868304518, 735478708, 567830257, 566420502, 479886544, 198138351, 430954468,
                        832310941, 955398557, 332469967, 157393959, 922825728, 755143472, 12260341, 847039435,
                        824906354, 448948974, 610592217, 839671497, 945921755, 383696343, 937983763,
                        572133680, 733130759, 935859562, 727035131, 778092804, 290324125, 348426074,
                        619995463, 776343839, 451668278, 390760026, 32516788, 364897849, 359429304, 366149830,
                        682653376, 671545484, 186188393, 822179506, 864389132, 206547460, 330793846,
                        506774295, 9259558, 771094635, 469258862, 281676889, 139307297, 514055295, 253881148,
                        70226081, 666734875, 737910154, 550473561, 254009998, 495138208, 338417386, 897518200,
                        69078050, 930521987, 422483275, 869351208, 754066409, 985804066, 79850593, 156535734,
                        205980134, 944774418, 888723162, 106706900, 463414197, 995665581, 177685712,
                        989176427, 714905944, 567734827, 911593043, 895098518, 775937414, 837330918,
                        563771581, 402050906, 660686197, 714673525, 600111818, 171215322, 324236194,
                        632913131, 949194424, 424572824, 29151259}, 709797321));
        System.out.println(minSubarray(new int[]{3, 1, 4, 2}, 6));
        System.out.println(minSubarray(new int[]{6, 3, 5, 2}, 9));
        System.out.println(minSubarray(new int[]{1, 2, 3}, 3));
        System.out.println(minSubarray(new int[]{1, 2, 3}, 7));
        System.out.println(minSubarray(new int[]{1000000000, 1000000000, 1000000000}, 3));
    }

    public static int minSubarray(int[] nums, int p) {
        int result = Integer.MAX_VALUE;
        long sum = 0L;
        long prefixSum = 0L;
        int length = nums.length;
        /**
         * 余数i -> 遍历过程中前缀和模p余数为i的最后一个数的索引位置
         */
        Map<Integer, Integer> remainderMap = new HashMap<>();
        remainderMap.put(0, -1);

        for (int i = 0; i < length; i++) {
            sum += nums[i];
        }
        /**
         * 数组nums中所有元素之和模p的余数
         */
        int remainder = (int) (sum % p);
        /**
         * 不用移除任何元素就能满足题目要求
         */
        if (remainder == 0) {
            return 0;
        }

        for (int i = 0; i < length; i++) {
            prefixSum += nums[i];
            /**
             * 数组nums的子数组[nums[0],nums[0],……,nums[i]]所有元素之和模p的余数
             */
            int currRemainder = (int) (prefixSum % p);
            /**
             * 为了使得数组nums移除掉某个子数组[nums[k],nums[k+1],……nums[i]]后剩下的所有元素之和可以被p整除，需要找到一个
             * 子数组[nums[0],nums[1],……,nums[k-1]]，其中所有元素之和模p的余数为otherRemainder
             */
            int prevRemainder =
                    currRemainder >= remainder ? currRemainder - remainder : currRemainder + p - remainder;
            /**
             * 判断遍历过程中是否已经得到过符合以上条件的子数组[nums[0],nums[1],……,nums[k-1]]
             */
            if (remainderMap.containsKey(prevRemainder) &&
                    !Objects.equals(remainderMap.get(prevRemainder), length)) {
                result = Math.min(result, i - remainderMap.get(prevRemainder));
            }
            remainderMap.put(currRemainder, i);
        }
        return result == Integer.MAX_VALUE || result == length ? -1 : result;
    }
}
